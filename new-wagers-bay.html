<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>New Wagers Bay - AntiTarheel</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@300;400;600;700&family=Orbitron:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* Additional styles specific to New Wagers Bay page */
      .wagers-section {
        padding: 80px 0;
      }

      .wagers-container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 0 20px;
      }

      .wagers-intro {
        text-align: center;
        margin-bottom: 60px;
      }

      .wagers-intro h3 {
        font-family: var(--secondary-font);
        font-size: 2.5rem;
        margin-bottom: 20px;
        color: var(--action-green);
      }

      .wagers-intro p {
        font-size: 1.2rem;
        max-width: 800px;
        margin: 0 auto 30px;
        color: var(--wolf-gray);
      }

      .upload-button {
        display: inline-block;
        padding: 12px 25px;
        background-color: var(--action-green);
        color: var(--college-navy);
        border-radius: 50px;
        font-weight: 700;
        font-size: 1rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-top: 15px;
        transition: all 0.3s ease;
      }

      .upload-button i {
        margin-right: 8px;
      }

      .upload-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }

      /* Slideshow Styles */
      .slideshow-container {
        position: relative;
        max-width: 1000px;
        margin: 0 auto 60px;
        background-color: rgba(0, 34, 68, 0.8);
        border-radius: 10px;
        padding: 20px;
        border: 1px solid var(--wolf-gray);
      }

      .slideshow-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(165, 172, 175, 0.3);
      }

      .slideshow-title {
        font-family: var(--secondary-font);
        font-size: 1.8rem;
        color: var(--action-green);
      }

      .slideshow-date {
        font-size: 1.2rem;
        color: var(--wolf-gray);
        font-weight: 600;
      }

      .slides-wrapper {
        position: relative;
        overflow: hidden;
        border-radius: 8px;
        height: 500px;
      }

      .mySlides {
        display: none;
        width: 100%;
        height: 100%;
      }

      .mySlides img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 8px;
      }

      .prev,
      .next {
        cursor: pointer;
        position: absolute;
        top: 50%;
        width: auto;
        margin-top: -22px;
        padding: 16px;
        color: white;
        font-weight: bold;
        font-size: 18px;
        transition: 0.6s ease;
        border-radius: 0 3px 3px 0;
        user-select: none;
        background-color: rgba(0, 0, 0, 0.4);
        z-index: 10;
      }

      .next {
        right: 20px;
        border-radius: 3px 0 0 3px;
      }

      .prev {
        left: 20px;
        border-radius: 0 3px 3px 0;
      }

      .prev:hover,
      .next:hover {
        background-color: var(--action-green);
      }

      /* Calendar Styles */
      .date-navigation {
        text-align: center;
        margin-top: 20px;
        display: flex;
        justify-content: center;
        flex-direction: column;
        align-items: center;
      }

      .calendar-toggle {
        padding: 10px 20px;
        background-color: rgba(0, 34, 68, 0.9);
        color: var(--white);
        border: 1px solid var(--wolf-gray);
        border-radius: 30px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: var(--secondary-font);
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 15px;
      }

      .calendar-toggle:hover {
        background-color: var(--action-green);
        color: var(--college-navy);
        border-color: var(--action-green);
      }

      .calendar-container {
        display: none;
        background-color: rgba(0, 34, 68, 0.9);
        border-radius: 10px;
        padding: 20px;
        border: 1px solid var(--wolf-gray);
        margin-top: 15px;
        width: 100%;
        max-width: 400px;
      }

      .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .calendar-nav {
        display: flex;
        gap: 10px;
      }

      .calendar-nav-btn {
        background-color: transparent;
        border: none;
        color: var(--white);
        font-size: 1.2rem;
        cursor: pointer;
        transition: color 0.3s ease;
      }

      .calendar-nav-btn:hover {
        color: var(--action-green);
      }

      .calendar-month-year {
        font-family: var(--secondary-font);
        font-size: 1.3rem;
        color: var(--action-green);
      }

      .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
      }

      .calendar-day-header {
        text-align: center;
        font-weight: 600;
        color: var(--wolf-gray);
        padding: 5px;
        font-size: 0.9rem;
      }

      .calendar-day {
        text-align: center;
        padding: 8px;
        border-radius: 5px;
        cursor: default;
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.5);
      }

      .calendar-day.current-month {
        color: var(--white);
      }

      .calendar-day.has-content {
        background-color: rgba(105, 190, 40, 0.2);
        cursor: pointer;
        font-weight: 600;
        border: 1px solid rgba(105, 190, 40, 0.3);
      }

      .calendar-day.has-content:hover {
        background-color: rgba(105, 190, 40, 0.4);
      }

      .calendar-day.selected {
        background-color: var(--action-green);
        color: var(--college-navy);
      }

      .no-content-message {
        display: none;
        text-align: center;
        color: var(--wolf-gray);
        margin-top: 15px;
        font-style: italic;
      }

      /* History Section */
      .history-section {
        margin: 80px 0;
        background-color: rgba(0, 34, 68, 0.8);
        border-radius: 10px;
        padding: 40px;
        border: 1px solid var(--wolf-gray);
      }

      .history-section h3 {
        font-family: var(--secondary-font);
        font-size: 2rem;
        margin-bottom: 30px;
        color: var(--action-green);
        text-align: center;
      }

      .history-content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 40px;
        align-items: center;
      }

      .history-text {
        color: var(--wolf-gray);
        line-height: 1.8;
      }

      .history-text p {
        margin-bottom: 20px;
      }

      .history-image {
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        border: 2px solid var(--action-green);
      }

      .history-image img {
        width: 100%;
        height: auto;
        display: block;
      }

      /* Mods and Maps Section */
      .resources-section {
        margin: 80px 0;
      }

      .resources-section h3 {
        font-family: var(--secondary-font);
        font-size: 2rem;
        margin-bottom: 40px;
        color: var(--action-green);
        text-align: center;
      }

      .resources-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
      }

      .resource-card {
        background-color: rgba(0, 34, 68, 0.8);
        border-radius: 10px;
        overflow: hidden;
        border: 1px solid var(--wolf-gray);
        transition: all 0.3s ease;
      }

      .resource-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        border-color: var(--action-green);
      }

      .resource-image {
        height: 200px;
        overflow: hidden;
      }

      .resource-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
      }

      .resource-card:hover .resource-image img {
        transform: scale(1.1);
      }

      .resource-content {
        padding: 20px;
        text-align: center;
      }

      .resource-content h4 {
        font-family: var(--secondary-font);
        font-size: 1.5rem;
        margin-bottom: 15px;
        color: var(--white);
      }

      .resource-content p {
        color: var(--wolf-gray);
        margin-bottom: 20px;
      }

      /* Navigation Icons */
      .nav-icons {
        display: flex;
        align-items: center;
        margin-left: 20px;
      }

      .cart-icon-container {
        position: relative;
      }

      #cart-icon {
        font-size: 1.3rem;
        color: var(--white);
        position: relative;
        display: inline-block;
        padding: 5px;
        transition: all 0.3s ease;
      }

      #cart-icon:hover {
        color: var(--action-green);
        transform: scale(1.1);
      }

      .cart-count {
        position: absolute;
        top: -8px;
        right: -8px;
        background-color: var(--action-green);
        color: var(--college-navy);
        font-size: 0.7rem;
        font-weight: bold;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
      }

      .help-icon-container {
        margin-left: 15px;
        position: relative;
      }

      #help-icon {
        font-size: 1.3rem;
        color: var(--white);
        position: relative;
        display: inline-block;
        padding: 5px;
        transition: all 0.3s ease;
      }

      #help-icon:hover {
        color: var(--action-green);
        transform: scale(1.1);
      }

      /* Navigation and dropdown styles */
      .nav-menu li {
        position: relative;
      }
      
      .dropdown-menu {
        position: absolute;
        top: 100%;
        left: 0;
        background-color: rgba(0, 34, 68, 0.95);
        border: 1px solid var(--wolf-gray);
        border-radius: 0 0 5px 5px;
        min-width: 200px;
        padding: 10px 0;
        z-index: 100;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
        transition: all 0.3s ease;
      }
      
      .nav-menu li:hover .dropdown-menu {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }
      
      .dropdown-menu li {
        display: block;
        width: 100%;
      }
      
      .dropdown-menu a {
        display: block;
        padding: 10px 20px;
        color: var(--white);
        font-size: 0.9rem;
      }
      
      .dropdown-menu a:hover {
        background-color: rgba(105, 190, 40, 0.2);
      }
      
      .nav-menu .dropdown-toggle {
        position: relative;
        padding-right: 18px;
      }
      
      .nav-menu .dropdown-toggle::after {
        content: '\f078';
        font-family: 'Font Awesome 5 Free';
        font-weight: 900;
        font-size: 0.7rem;
        position: absolute;
        right: 0;
        top: 50%;
        transform: translateY(-50%);
        transition: all 0.3s ease;
      }
      
      .nav-menu li:hover .dropdown-toggle::after {
        transform: translateY(-50%) rotate(180deg);
      }
      
      @media screen and (max-width: 768px) {
        .dropdown-menu {
          position: static;
          opacity: 1;
          visibility: visible;
          transform: none;
          background-color: transparent;
          border: none;
          min-width: auto;
          padding: 0 0 0 20px;
          display: none;
        }
        
        .dropdown-menu.active {
          display: block;
        }
        
        .dropdown-menu a {
          padding: 8px 15px;
        }
        
        .nav-menu .dropdown-toggle::after {
          right: 15px;
        }
        
        .nav-icons {
          position: absolute;
          right: 60px;
          top: 20px;
        }
      }

      /* Responsive Styles */
      @media screen and (max-width: 992px) {
        .slides-wrapper {
          height: 400px;
        }
      }

      @media screen and (max-width: 768px) {
        .history-content {
          grid-template-columns: 1fr;
        }

        .history-image {
          order: 1;
          margin-bottom: 30px;
        }

        .history-text {
          order: 2;
        }

        .slides-wrapper {
          height: 350px;
        }
      }

      @media screen and (max-width: 576px) {
        .slideshow-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 10px;
        }

        .slides-wrapper {
          height: 250px;
        }

        .prev,
        .next {
          padding: 10px;
          margin-top: -15px;
        }
      }
    </style>
  </head>
  <body>
    <div class="background-container">
      <!-- Background will be added via CSS -->
    </div>

    <header>
      <div class="logo">
        <h1>AntiTarheel</h1>
      </div>
      <nav>
        <div class="menu-toggle">
          <i class="fas fa-bars"></i>
        </div>
        <ul class="nav-menu">
          <li><a href="index.html" id="nav-home">Home</a></li>
          <li><a href="commands.html" id="nav-commands">Commands</a></li>
          <li>
            <a href="new-wagers-bay.html" id="nav-wagers" class="active">New Wagers Bay</a>
          </li>
          <li><a href="discord.html" id="nav-discord">Discord</a></li>
          <li><a href="store.html" id="nav-store">Store</a></li>
        </ul>
        <div class="nav-icons">
          <div class="cart-icon-container">
            <a href="store.html#cart-section" id="cart-icon">
              <i class="fas fa-shopping-cart"></i>
              <span class="cart-count" id="cart-count">0</span>
            </a>
          </div>
          <div class="help-icon-container">
            <a href="contact.html" id="help-icon" title="Help">
              <i class="fas fa-question-circle"></i>
            </a>
          </div>
        </div>
      </nav>
    </header>

    <main>
      <section class="wagers-section">
        <div class="wagers-container">
          <div class="wagers-intro">
            <h3>Stream Gallery</h3>
            <p>
              Browse through images from AntiTarheel's streams. Navigate between
              different dates to see the evolution of builds and memorable
              moments.
            </p>
          </div>

          <!-- Slideshow Container -->
          <div class="slideshow-container">
            <div class="slideshow-header">
              <div class="slideshow-title">Stream Highlights</div>
              <div class="slideshow-date" id="current-date">March 06, 2025</div>
            </div>

            <div class="slides-wrapper">
              <!-- Full-width images with number and caption text -->
              <div class="mySlides fade">
                <img
                  src="data:image/svg+xml;charset=UTF-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1000' height='500' viewBox='0 0 1000 500' preserveAspectRatio='none'%3E%3Crect width='1000' height='500' fill='%23003366'%3E%3C/rect%3E%3Ctext x='500' y='220' style='fill:%23FFFFFF;font-weight:bold;font-family:Arial, Helvetica, sans-serif;font-size:36px;text-anchor:middle;dominant-baseline:middle'%3EStream Image 1%3C/text%3E%3Ctext x='500' y='280' style='fill:%23FFFFFF;font-family:Arial, Helvetica, sans-serif;font-size:22px;text-anchor:middle;dominant-baseline:middle'%3ESelect a date to view images%3C/text%3E%3C/svg%3E"
                  alt="Stream Image 1"
                />
              </div>

              <div class="mySlides fade">
                <img
                  src="data:image/svg+xml;charset=UTF-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1000' height='500' viewBox='0 0 1000 500' preserveAspectRatio='none'%3E%3Crect width='1000' height='500' fill='%23003366'%3E%3C/rect%3E%3Ctext x='500' y='220' style='fill:%23FFFFFF;font-weight:bold;font-family:Arial, Helvetica, sans-serif;font-size:36px;text-anchor:middle;dominant-baseline:middle'%3EStream Image 2%3C/text%3E%3Ctext x='500' y='280' style='fill:%23FFFFFF;font-family:Arial, Helvetica, sans-serif;font-size:22px;text-anchor:middle;dominant-baseline:middle'%3ESelect a date to view images%3C/text%3E%3C/svg%3E"
                  alt="Stream Image 2"
                />
              </div>

              <div class="mySlides fade">
                <img
                  src="data:image/svg+xml;charset=UTF-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1000' height='500' viewBox='0 0 1000 500' preserveAspectRatio='none'%3E%3Crect width='1000' height='500' fill='%23003366'%3E%3C/rect%3E%3Ctext x='500' y='220' style='fill:%23FFFFFF;font-weight:bold;font-family:Arial, Helvetica, sans-serif;font-size:36px;text-anchor:middle;dominant-baseline:middle'%3EStream Image 3%3C/text%3E%3Ctext x='500' y='280' style='fill:%23FFFFFF;font-family:Arial, Helvetica, sans-serif;font-size:22px;text-anchor:middle;dominant-baseline:middle'%3ESelect a date to view images%3C/text%3E%3C/svg%3E"
                  alt="Stream Image 3"
                />
              </div>

              <!-- Next and previous buttons -->
              <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
              <a class="next" onclick="plusSlides(1)">&#10095;</a>
            </div>

            <!-- Date navigation buttons -->
            <div class="date-navigation">
              <button class="calendar-toggle" id="calendar-toggle">
                <i class="fas fa-calendar-alt"></i> Choose a Date
              </button>
              <div class="calendar-container" id="calendar-container">
                <div class="calendar-header">
                  <div class="calendar-nav">
                    <button class="calendar-nav-btn" id="prev-month">
                      <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="calendar-nav-btn" id="next-month">
                      <i class="fas fa-chevron-right"></i>
                    </button>
                  </div>
                  <div class="calendar-month-year" id="calendar-month-year">
                    March 2025
                  </div>
                </div>
                <div class="calendar-grid" id="calendar-grid">
                  <!-- Calendar days will be generated by JavaScript -->
                </div>
                <div class="no-content-message" id="no-content-message">
                  No content available for this month.
                </div>
              </div>
            </div>
          </div>

          <!-- History Section -->
          <div class="history-section">
            <h3>The Story of New Wagers Bay</h3>
            <div class="history-content">
              <div class="history-text">
                <p>
                  New Wagers Bay began as a small project in early 2022, born
                  from AntiTarheel's passion for creating immersive environments
                  for the community. What started as a simple build quickly
                  evolved into an expansive world with its own lore and
                  character.
                </p>
                <p>
                  The map name "New Wagers Bay" is in honor of an old friend Antitarheel lost years ago. As the build grew, so did
                  the stories and memories associated with it. Each stream added
                  new elements, shaped by viewer suggestions and AntiTarheel's
                  creative vision.
                </p>
                <p>
                  Today, New Wagers Bay stands as a testament to community
                  collaboration and creativity. Future plans include expanding
                  the eastern district, adding an underwater section, and
                  creating special event areas for community gatherings.
                </p>
              </div>
              <div class="history-image">
                <img src="assets/NWB.png" alt="New Wagers Bay History" />
              </div>
            </div>
          </div>

          <!-- Mods and Maps Section -->
          <div class="resources-section">
            <h3>Mods & Maps</h3>
            <div class="resources-grid">
              <div class="resource-card">
                <a
                  href="https://steamcommunity.com/sharedfiles/filedetails/?id=2791489818"
                  target="_blank"
                >
                  <div class="resource-image">
                    <img src="assets/1.png" alt="Mods Collection" />
                  </div>
                  <div class="resource-content">
                    <h4>Current Mods</h4>
                    <p>
                      Complete collection of mods used in New Wagers Bay builds
                    </p>
                    <button class="btn secondary-btn">View Mods</button>
                  </div>
                </a>
              </div>

              <div class="resource-card">
                <a href="#" target="_blank">
                  <div class="resource-image">
                    <img src="assets/2.png" alt="World Map" />
                  </div>
                  <div class="resource-content">
                    <h4>Interactive Map</h4>
                    <p>
                      Explore the full map of New Wagers Bay with points of
                      interest
                    </p>
                    <button class="btn secondary-btn">Open Map</button>
                  </div>
                </a>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <div class="footer-content">
        <div class="footer-logo">
          <h2>AntiTarheel</h2>
          <p>Twitch Streamer & Content Creator</p>
        </div>
        <div class="footer-links">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="store.html">Store</a></li>
            <li><a href="commands.html">Commands</a></li>
            <li><a href="new-wagers-bay.html">New Wagers Bay</a></li>
          </ul>
        </div>
        <div class="footer-social">
          <h3>Connect</h3>
          <div class="social-icons">
            <a href="https://www.twitch.tv/antitarheel" target="_blank"
              ><i class="fab fa-twitch"></i
            ></a>
            <a href="https://discord.com/invite/yJDmPAMQMy" target="_blank"
              ><i class="fab fa-discord"></i
            ></a>
            <a href="https://www.youtube.com/@Antitarheel" target="_blank"
              ><i class="fab fa-youtube"></i
            ></a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 AntiTarheel. All Rights Reserved.</p>
        <div class="admin-link">
          <a href="new-wagers-bay-image-upload.html" style="color: var(--college-navy); font-size: 0.7rem; opacity: 0.3; text-decoration: none; transition: opacity 0.3s ease;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='0.3'">Admin</a>
        </div>
      </div>
    </footer>

    <script src="script.js"></script>
    <script src="image-locations.js"></script>
    <script>
      // Slideshow functionality
      let slideIndex = 1;
      showSlides(slideIndex);

      function plusSlides(n) {
        showSlides((slideIndex += n));
      }

      function currentSlide(n) {
        showSlides((slideIndex = n));
      }

      function showSlides(n) {
        let i;
        let slides = document.getElementsByClassName("mySlides");

        // If no slides, return early
        if (slides.length === 0) {
          console.log("No slides to show");
          return;
        }

        if (n > slides.length) {
          slideIndex = 1;
        }
        if (n < 1) {
          slideIndex = slides.length;
        }

        // Hide all slides
        for (i = 0; i < slides.length; i++) {
          slides[i].style.display = "none";
        }

        // Show the current slide
        slides[slideIndex - 1].style.display = "block";

        // Log the current slide for debugging
        console.log(`Showing slide ${slideIndex} of ${slides.length}`);
      }

      // Calendar functionality
      document.addEventListener("DOMContentLoaded", function () {
        const calendarToggle = document.getElementById("calendar-toggle");
        const calendarContainer = document.getElementById("calendar-container");
        const calendarGrid = document.getElementById("calendar-grid");
        const calendarMonthYear = document.getElementById(
          "calendar-month-year"
        );
        const prevMonthBtn = document.getElementById("prev-month");
        const nextMonthBtn = document.getElementById("next-month");
        const noContentMessage = document.getElementById("no-content-message");
        const currentDateDisplay = document.getElementById("current-date");
        const slidesWrapper = document.querySelector(".slides-wrapper");

        // Initialize with current date
        let currentDate = new Date();
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();

        // List of dates that have content - will be loaded from folder_list.txt
        let knownDates = [];
        
        // Load the dates from folder_list.txt
        fetch('assets/images/wagers-bay-dates/folder_list.txt')
          .then(response => response.text())
          .then(text => {
            // Parse the text file into an array of dates
            knownDates = text.split('\n')
              .map(line => line.trim())
              .filter(line => line.length > 0);
              
            // Initialize the calendar now that we have the dates
            initCalendar();
            
            // Find the most recent date that has images
            findMostRecentDateWithImages(knownDates);
          })
          .catch(error => {
            console.error('Error loading date list:', error);
            // Fallback to initialize without dates
            initCalendar();
            generateCalendar();
          });
          
        // Function to find the most recent date that actually has images
        function findMostRecentDateWithImages(dateList) {
          if (dateList.length === 0) {
            // No dates available
            generateCalendar();
            return;
          }
          
          // Sort dates in descending order (newest first)
          const sortedDates = [...dateList].sort().reverse();
          
          // Try to load each date in sequence until we find one with images
          tryNextDate(sortedDates, 0);
        }
        
        // Recursively try dates until we find one with images
        function tryNextDate(sortedDates, index) {
          if (index >= sortedDates.length) {
            // We've tried all dates and none had images
            console.log('No date with valid images found');
            generateCalendar();
            return;
          }
          
          const dateToTry = sortedDates[index];
          console.log(`Checking if date ${dateToTry} has images...`);
          
          // First check if the date exists in imageLocations
          if (typeof imageLocations === 'object' && 
              imageLocations[dateToTry] && 
              imageLocations[dateToTry].length > 0) {
            
            console.log(`Found images for ${dateToTry} in imageLocations`);
            loadDateContent(dateToTry);
            return;
          }
          
          // If not in imageLocations, check the directory
          fetch(`list-images.php?date=${dateToTry}`)
            .then(response => response.json())
            .then(data => {
              if (data.success && data.images && data.images.length > 0) {
                // This date has images, use it
                console.log(`Found images for ${dateToTry} using directory listing`);
                loadDateContent(dateToTry);
              } else {
                // No images for this date, try the next one
                console.log(`No images found for ${dateToTry}, trying next date...`);
                tryNextDate(sortedDates, index + 1);
              }
            })
            .catch(error => {
              console.error(`Error checking images for ${dateToTry}:`, error);
              // Try the next date
              tryNextDate(sortedDates, index + 1);
            });
        }
        
        // Function to load content for a valid date
        function loadDateContent(dateStr) {
          // Format the date for display
          const [year, month, day] = dateStr.split('-').map(num => parseInt(num));
          const displayDate = new Date(year, month - 1, day).toLocaleDateString('en-US', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          });
          
          // Set the current month and year to this date
          currentMonth = month - 1; // Adjust for 0-indexed months
          currentYear = year;
          
          // Load content for this date
          loadContentForDate(dateStr, displayDate);
          
          // Generate the calendar with the current month/year
          generateCalendar();
        }

        // Function to initialize the calendar UI elements
        function initCalendar() {
          // Initialize the page
          function initializeCalendar() {
            // Generate the days of the week
            const daysOfWeek = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
            const dayHeaders = daysOfWeek
              .map(
                (day) => `<div class="calendar-day-header">${day}</div>`
              )
              .join("");
            calendarGrid.innerHTML = dayHeaders;

            // Toggle calendar view
            calendarToggle.addEventListener("click", function () {
              if (
                calendarContainer.style.display === "none" ||
                calendarContainer.style.display === ""
              ) {
                calendarContainer.style.display = "block";
                calendarToggle.textContent = "Hide Calendar";
                generateCalendar();
              } else {
                calendarContainer.style.display = "none";
                calendarToggle.textContent = "Show Calendar";
              }
            });

            // Navigation buttons
            prevMonthBtn.addEventListener("click", function () {
              currentMonth--;
              if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
              }
              generateCalendar();
            });

            nextMonthBtn.addEventListener("click", function () {
              currentMonth++;
              if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
              }
              generateCalendar();
            });
          }

          // Call the initialization function
          initializeCalendar();
        }

        // Function to generate the calendar
        function generateCalendar() {
          // Clear previous calendar
          calendarGrid.innerHTML = "";

          // Add day headers
          const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
          dayNames.forEach((day) => {
            const dayHeader = document.createElement("div");
            dayHeader.className = "calendar-day-header";
            dayHeader.textContent = day;
            calendarGrid.appendChild(dayHeader);
          });

          // Set month and year
          const monthNames = [
            "January",
            "February",
            "March",
            "April",
            "May",
            "June",
            "July",
            "August",
            "September",
            "October",
            "November",
            "December",
          ];
          calendarMonthYear.textContent = `${monthNames[currentMonth]} ${currentYear}`;

          // Get first day of month and total days in month
          const firstDay = new Date(currentYear, currentMonth, 1).getDay();
          const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

          // Get days from previous month
          const daysInPrevMonth = new Date(currentYear, currentMonth, 0).getDate();

          // Add days from previous month
          for (let i = firstDay - 1; i >= 0; i--) {
            const day = document.createElement("div");
            day.className = "calendar-day";
            day.textContent = daysInPrevMonth - i;
            calendarGrid.appendChild(day);
          }

          // Check if this month has any content
          let hasContentThisMonth = false;

          // Add days of current month
          for (let i = 1; i <= daysInMonth; i++) {
            const day = document.createElement("div");
            day.className = "calendar-day current-month";
            day.textContent = i;

            // Format date string for comparison
            const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(
              2,
              "0"
            )}-${String(i).padStart(2, "0")}`;

            // Check if this date is in our known dates
            if (knownDates.includes(dateStr)) {
              day.classList.add("has-content");
              hasContentThisMonth = true;

              // Add click event to load content for this date
              day.addEventListener("click", function () {
                // Format date for display
                const displayDate = formatDateForDisplay(dateStr);

                // Load content for this date
                loadContentForDate(dateStr, displayDate);

                // Close calendar after selection
                calendarContainer.style.display = "none";

                // Update selected day styling
                const selectedDays = document.querySelectorAll(
                  ".calendar-day.selected"
                );
                selectedDays.forEach((el) => el.classList.remove("selected"));
                day.classList.add("selected");
              });
            }

            calendarGrid.appendChild(day);
          }

          // Fill remaining grid with days from next month
          const totalCells = 42; // 6 rows of 7 days
          const remainingCells = totalCells - (firstDay + daysInMonth);

          for (let i = 1; i <= remainingCells; i++) {
            const day = document.createElement("div");
            day.className = "calendar-day";
            day.textContent = i;
            calendarGrid.appendChild(day);
          }

          // Show/hide no content message
          if (hasContentThisMonth) {
            noContentMessage.style.display = "none";
          } else {
            noContentMessage.style.display = "block";
          }
        }

        // Helper function to format date string for display
        function formatDateForDisplay(dateStr) {
          const [year, month, day] = dateStr.split("-");
          const date = new Date(year, month - 1, day);
          return date.toLocaleDateString("en-US", {
            month: "long",
            day: "numeric",
            year: "numeric",
          });
        }

        // Function to load content for a specific date
        function loadContentForDate(dateStr, displayDate) {
          console.log(`Loading content for date: ${dateStr} (${displayDate})`);
          
          // Update the displayed date
          currentDateDisplay.textContent = displayDate;

          // Clear the current slides
          slidesWrapper.innerHTML = "";

          // Show loading indicator
          const loadingSlide = document.createElement("div");
          loadingSlide.className = "mySlides fade";
          loadingSlide.style.display = "block";
          loadingSlide.innerHTML = `
            <div style="display: flex; justify-content: center; align-items: center; height: 100%; background-color: rgba(0, 34, 68, 0.8);">
              <div style="text-align: center; color: var(--wolf-gray);">
                <div style="margin-bottom: 15px;">Loading images for ${displayDate}...</div>
                <div style="border: 4px solid rgba(165, 172, 175, 0.3); border-top: 4px solid var(--action-green); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto;"></div>
              </div>
            </div>
          `;
          slidesWrapper.appendChild(loadingSlide);

          // Add a style for the loading spinner animation if it doesn't exist
          if (!document.querySelector("style#loading-spinner-style")) {
            const style = document.createElement("style");
            style.id = "loading-spinner-style";
            style.textContent = `
              @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
              }
            `;
            document.head.appendChild(style);
          }

          console.log(`Checking for images in imageLocations for date: ${dateStr}`);
          
          // Check if we have images for this date in the imageLocations object
          if (typeof imageLocations === 'object' && imageLocations[dateStr] && imageLocations[dateStr].length > 0) {
            console.log(`Found ${imageLocations[dateStr].length} images for ${dateStr} in imageLocations`);
            // Get the images and create the slideshow
            const images = imageLocations[dateStr];
            createSlideshow(images, displayDate);
          } else {
            console.log(`No images found for ${dateStr} in imageLocations, checking directory...`);
            
            // If not in imageLocations, try to use a directory listing approach
            // Create a simple PHP file to list files in the directory
            fetch(`list-images.php?date=${dateStr}`)
              .then(response => response.json())
              .then(data => {
                if (data.success && data.images && data.images.length > 0) {
                  console.log(`Found ${data.images.length} images using directory listing`);
                  createSlideshow(data.images, displayDate);
                } else {
                  console.log(`No images found in directory for ${dateStr}`);
                  loadPlaceholderContent(dateStr, displayDate);
                }
              })
              .catch(error => {
                console.error(`Error listing images for ${dateStr}:`, error);
                loadPlaceholderContent(dateStr, displayDate);
              });
          }
        }

        // Function to create slideshow from images
        function createSlideshow(images, displayDate) {
          // Clear the slides wrapper
          slidesWrapper.innerHTML = "";

          // Track loaded and failed images
          let loadedImages = 0;
          let failedImages = 0;
          const totalImages = images.length;

          console.log(
            `Creating slideshow with ${totalImages} images for ${displayDate}`
          );
          console.log(`Image paths:`, images);

          // Create slides for each image
          images.forEach((image, index) => {
            const slide = document.createElement("div");
            slide.className = "mySlides fade";
            slide.style.display = index === 0 ? "block" : "none";
            slide.dataset.index = index; // Store the index for easier reference

            const img = document.createElement("img");
            img.src = image;
            img.alt = `Image ${index + 1} from ${displayDate}`;

            // Handle image load success
            img.onload = function () {
              loadedImages++;
              console.log(
                `✅ Loaded image ${
                  loadedImages + failedImages
                }/${totalImages} for ${displayDate}: ${image}`
              );

              // If all images have been processed (loaded or failed)
              if (loadedImages + failedImages === totalImages) {
                console.log(
                  `All images processed: ${loadedImages} loaded, ${failedImages} failed`
                );

                // If no images loaded successfully, show placeholder
                if (loadedImages === 0) {
                  console.log(
                    `❌ No images loaded successfully for ${displayDate}. Showing placeholder.`
                  );
                  loadPlaceholderContent(
                    displayDate.split(" ").join("-"),
                    displayDate
                  );
                  return;
                }

                // If we have at least one successful image, make sure navigation is set up correctly
                updateNavigationButtons();
              }
            };

            // Handle image load failure
            img.onerror = function () {
              failedImages++;
              console.log(
                `❌ Failed to load image ${
                  loadedImages + failedImages
                }/${totalImages} for ${displayDate}: ${image}`
              );

              // Remove this slide from the DOM to avoid showing broken images
              if (slidesWrapper.contains(slide)) {
                slidesWrapper.removeChild(slide);
              }

              // If all images have been processed (loaded or failed)
              if (loadedImages + failedImages === totalImages) {
                console.log(
                  `All images processed: ${loadedImages} loaded, ${failedImages} failed`
                );

                // If no images loaded successfully, show placeholder
                if (loadedImages === 0) {
                  console.log(
                    `❌ No images loaded successfully for ${displayDate}. Showing placeholder.`
                  );
                  loadPlaceholderContent(
                    displayDate.split(" ").join("-"),
                    displayDate
                  );
                  return;
                }

                // If we have at least one successful image, make sure navigation is set up correctly
                updateNavigationButtons();
              }
            };

            slide.appendChild(img);
            slidesWrapper.appendChild(slide);
          });

          // Function to update navigation buttons after all images are processed
          function updateNavigationButtons() {
            // Remove any existing navigation buttons
            const existingPrevBtn = slidesWrapper.querySelector(".prev");
            const existingNextBtn = slidesWrapper.querySelector(".next");
            if (existingPrevBtn) slidesWrapper.removeChild(existingPrevBtn);
            if (existingNextBtn) slidesWrapper.removeChild(existingNextBtn);

            // Add navigation buttons
            const prevBtn = document.createElement("a");
            prevBtn.className = "prev";
            prevBtn.innerHTML = "&#10094;";
            prevBtn.onclick = function () {
              plusSlides(-1);
            };

            const nextBtn = document.createElement("a");
            nextBtn.className = "next";
            nextBtn.innerHTML = "&#10095;";
            nextBtn.onclick = function () {
              plusSlides(1);
            };

            slidesWrapper.appendChild(prevBtn);
            slidesWrapper.appendChild(nextBtn);

            // Reset slideshow
            slideIndex = 1;
            showSlides(slideIndex);
          }

          // Add initial navigation buttons (these might be updated later)
          const prevBtn = document.createElement("a");
          prevBtn.className = "prev";
          prevBtn.innerHTML = "&#10094;";
          prevBtn.onclick = function () {
            plusSlides(-1);
          };

          const nextBtn = document.createElement("a");
          nextBtn.className = "next";
          nextBtn.innerHTML = "&#10095;";
          nextBtn.onclick = function () {
            plusSlides(1);
          };

          slidesWrapper.appendChild(prevBtn);
          slidesWrapper.appendChild(nextBtn);

          // Reset slideshow
          slideIndex = 1;
          showSlides(slideIndex);

          // Update the current date display
          currentDateDisplay.textContent = displayDate;
        }

        // Function to load placeholder content when no images are found
        function loadPlaceholderContent(dateStr, displayDate) {
          console.log(`Loading placeholder content for date: ${dateStr}`);
          
          // Clear the slides wrapper
          slidesWrapper.innerHTML = "";
          
          // Create a single placeholder slide
          const placeholderSlide = document.createElement("div");
          placeholderSlide.className = "mySlides fade";
          placeholderSlide.style.display = "block";
          
          // Format day name with date
          const formattedDate = new Date(dateStr + "T00:00:00").toLocaleDateString('en-US', {
            weekday: 'long',
            month: 'long',
            day: 'numeric',
            year: 'numeric'
          });
          
          // Create a more informative placeholder with error information
          placeholderSlide.innerHTML = `
            <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; background-color: rgba(0, 34, 68, 0.9); padding: 20px; text-align: center;">
              <h2 style="color: var(--wolf-gray); margin-bottom: 10px; font-size: 24px;">No Images Found</h2>
              <p style="color: white; font-size: 18px; margin-bottom: 25px;">${formattedDate}</p>
              
              <div style="background-color: rgba(0, 0, 0, 0.2); padding: 20px; border-radius: 8px; max-width: 80%;">
                <p style="color: var(--wolf-gray); margin-bottom: 15px;">No images could be loaded for this date. This could be due to:</p>
                <ul style="color: var(--wolf-gray); text-align: left; margin-bottom: 15px;">
                  <li>The folder exists but the image filenames don't match our expected patterns</li>
                  <li>The folder path is correct (assets/images/wagers-bay-dates/${dateStr}), but the images have different naming conventions</li>
                  <li>The folder exists but contains no images</li>
                </ul>
                <p style="color: var(--action-green); font-size: 14px;">For dates we haven't manually verified, we try to generate image paths based on common patterns. Check the console for more details about which paths were attempted.</p>
              </div>
            </div>
          `;
          
          slidesWrapper.appendChild(placeholderSlide);
          
          // Also show a console message for debugging
          console.error(`Failed to load images for date: ${dateStr}. Try checking the folder structure and image files.`);
        }

        // Function to get images for a specific date
        function getImagesForDate(dateStr) {
          console.log(`Getting images for date: ${dateStr}`);

          // Use the imageLocations object from the external file
          if (imageLocations[dateStr]) {
            console.log(
              `Found ${imageLocations[dateStr].length} images for ${dateStr} in imageLocations`
            );

            // For dates with generated paths, we need to be careful about 404 errors
            // Check if this is a generated path (it will be a function result)
            if (
              typeof imageLocations[dateStr][0] === "string" &&
              imageLocations[dateStr][0].includes(dateStr.replace(/-/g, ""))
            ) {
              console.log(
                `This date uses generated image paths. Some images might not exist.`
              );

              // For dates with generated paths, we'll check if we have manually verified the actual files
              // If we have, we'll use those instead
              const dateFolder = `assets/images/wagers-bay-dates/${dateStr}`;
              console.log(`Looking for images in folder: ${dateFolder}`);

              // We'll still return the generated paths, but the createSlideshow function
              // will handle any 404 errors gracefully
            }

            return imageLocations[dateStr];
          }

          // If no images found in the imageLocations object, create placeholders
          console.log(
            `No images found for ${dateStr} in imageLocations, creating placeholders`
          );
          return createPlaceholderImages(dateStr);
        }

        // Function to create placeholder images for a date
        function createPlaceholderImages(dateStr) {
          // Create an array of placeholder images
          const placeholders = [];

          // Add 3 placeholder images
          for (let i = 1; i <= 3; i++) {
            placeholders.push(createPlaceholderSVG(dateStr, i));
          }

          return placeholders;
        }

        // Function to create a placeholder SVG image
        function createPlaceholderSVG(dateStr, index) {
          // Format the date for display
          const [year, month, day] = dateStr.split("-");
          const date = new Date(year, month - 1, day);
          const displayDate = date.toLocaleDateString("en-US", {
            month: "long",
            day: "numeric",
            year: "numeric",
          });

          // Create an SVG placeholder
          return `data:image/svg+xml;charset=UTF-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1000' height='500' viewBox='0 0 1000 500' preserveAspectRatio='none'%3E%3Crect width='1000' height='500' fill='%23003366'%3E%3C/rect%3E%3Ctext x='500' y='180' style='fill:%23FFFFFF;font-weight:bold;font-family:Arial, Helvetica, sans-serif;font-size:36px;text-anchor:middle;dominant-baseline:middle'%3E${displayDate}%3C/text%3E%3Ctext x='500' y='240' style='fill:%23FFFFFF;font-family:Arial, Helvetica, sans-serif;font-size:24px;text-anchor:middle;dominant-baseline:middle'%3EImage ${index} of 3%3C/text%3E%3Ctext x='500' y='300' style='fill:%2369BE28;font-family:Arial, Helvetica, sans-serif;font-size:18px;text-anchor:middle;dominant-baseline:middle'%3EPlaceholder Image%3C/text%3E%3Ctext x='500' y='330' style='fill:%23A5ACAF;font-family:Arial, Helvetica, sans-serif;font-size:14px;text-anchor:middle;dominant-baseline:middle'%3ENo actual images available for this date%3C/text%3E%3C/svg%3E`;
        }
      });
    </script>
  </body>
</html>
